---
phase: 01-core-mcp-server
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - src/index.ts
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "npm install succeeds without errors"
    - "npm run build compiles TypeScript without errors"
    - "Server starts and logs to stderr"
  artifacts:
    - path: "package.json"
      provides: "Project configuration with MCP SDK dependency"
      contains: "@modelcontextprotocol/sdk"
    - path: "tsconfig.json"
      provides: "TypeScript configuration for Node16 modules"
      contains: "Node16"
    - path: "src/index.ts"
      provides: "MCP server entry point with stdio transport"
      min_lines: 20
  key_links:
    - from: "src/index.ts"
      to: "@modelcontextprotocol/sdk"
      via: "import McpServer, StdioServerTransport"
      pattern: "import.*McpServer.*from.*@modelcontextprotocol/sdk"
---

<objective>
Initialize the TypeScript MCP server project with proper configuration and dependencies. Create a minimal MCP server that connects via stdio transport.

Purpose: Establish the foundation for the AskUserQuestion tool - a properly configured TypeScript project with the MCP SDK that compiles and runs.

Output: A buildable, runnable MCP server skeleton that responds to protocol initialization.
</objective>

<execution_context>
@/Users/marcosandrade/.claude/get-shit-done/workflows/execute-plan.md
@/Users/marcosandrade/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-core-mcp-server/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize TypeScript project with MCP SDK</name>
  <files>package.json, tsconfig.json, .gitignore</files>
  <action>
Create the project foundation:

1. Initialize npm package:
   - name: "ask-user-mcp"
   - version: "1.0.0"
   - type: "module" (ES modules for MCP SDK)
   - main: "build/index.js"
   - scripts:
     - "build": "tsc"
     - "start": "node build/index.js"
     - "dev": "tsc --watch"

2. Install dependencies:
   - @modelcontextprotocol/sdk (MCP protocol handling)
   - zod (input validation, peer dependency of SDK)
   
3. Install dev dependencies:
   - typescript
   - @types/node

4. Create tsconfig.json:
   - target: ES2022
   - module: Node16
   - moduleResolution: Node16
   - outDir: ./build
   - rootDir: ./src
   - strict: true
   - esModuleInterop: true
   - skipLibCheck: true
   - forceConsistentCasingInFileNames: true

5. Update .gitignore:
   - node_modules/
   - build/
   - *.log
  </action>
  <verify>
Run: `npm install` - should complete without errors
Run: `npx tsc --version` - should show TypeScript version
Run: `cat package.json | grep "@modelcontextprotocol/sdk"` - should show dependency
  </verify>
  <done>
Package.json has all required dependencies and scripts. TypeScript config targets Node16 modules. Dependencies installed successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create minimal MCP server with stdio transport</name>
  <files>src/index.ts</files>
  <action>
Create src/index.ts implementing the basic MCP server:

1. Import from MCP SDK:
   - McpServer from "@modelcontextprotocol/sdk/server/mcp.js"
   - StdioServerTransport from "@modelcontextprotocol/sdk/server/stdio.js"

2. Create server instance:
   - name: "ask-user-mcp"
   - version: "1.0.0"

3. Create main() async function:
   - Instantiate StdioServerTransport
   - Call server.connect(transport)
   - Log startup message to stderr (IMPORTANT: use console.error, NOT console.log - stdout is reserved for JSON-RPC)

4. Call main() with .catch() error handler that:
   - Logs error to stderr
   - Exits with code 1

Note: Do NOT register any tools yet - that's Plan 02. This plan creates the foundation only.

Reference pattern from RESEARCH.md:
```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";

const server = new McpServer({
  name: "ask-user-mcp",
  version: "1.0.0",
});

async function main() {
  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.error("Ask User MCP Server running on stdio");
}

main().catch((error) => {
  console.error("Fatal error:", error);
  process.exit(1);
});
```
  </action>
  <verify>
Run: `npm run build` - should compile without errors
Run: `ls build/index.js` - should exist
Run: `timeout 2 node build/index.js 2>&1 || true` - should show "Ask User MCP Server running" in stderr (server will wait for input then timeout)
  </verify>
  <done>
MCP server compiles and runs. Server connects via stdio transport. Startup message appears in stderr (not stdout).
  </done>
</task>

</tasks>

<verification>
1. `npm install` completes without errors
2. `npm run build` compiles TypeScript without errors
3. `node build/index.js` starts server (will wait for JSON-RPC input)
4. No output on stdout during startup (stdout reserved for protocol)
5. Startup message appears on stderr
</verification>

<success_criteria>
- package.json contains @modelcontextprotocol/sdk and zod dependencies
- tsconfig.json configured for Node16 ES modules
- src/index.ts creates MCP server with stdio transport
- npm run build produces build/index.js
- Server starts without crashing
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-mcp-server/01-01-SUMMARY.md`
</output>
